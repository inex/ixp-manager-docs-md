<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="canonical" href="https://docs.ixpmanager.org/features/route-servers/">
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Route Servers - IXP Manager Documentation</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Route Servers";
    var mkdocs_page_input_path = "features/route-servers.md";
    var mkdocs_page_url = "/features/route-servers/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> IXP Manager Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Installation</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../install/">Introduction</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../install/automated-script/">Automated Script</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../install/maint-mode/">Maintenance Mode</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../install/manually/">Manual Installation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../install/upgrading/">Upgrading</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../install/runtime/">Runtime Configuration</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../install/next-steps/">Post-Install Steps</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">General Usage</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../usage/operational-notes/">Operational Notes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../usage/authentication/">Authentication</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../usage/contacts/">Contacts</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../usage/customers/">Customers / Members</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../usage/customer-notes/">Customer Notes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../usage/customer-tags/">Customer Tags</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../usage/interfaces/">Customer Connections</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../usage/users/">Users</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../usage/switches/">Switches</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../usage/email/">Email</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Features</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../api/">API</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../as112/">AS112</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../console-servers/">Console Servers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cronjobs/">Cron Jobs</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../patch-panels/">Cross Connects</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../dns-arpa/">DNS / ARPA</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../docstore/">Document Store</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../grapher/introduction/">Grapher</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../helpdesk/">Helpdesk Integration</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../irrdb/">IRRDB</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ixf-export/">IX-F Member Export</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../looking-glass/">Looking Glass</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../layer2-addresses/">MAC Addresses</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../manrs/">MANRS</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../member-export/">Member Export</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../mailing-lists/">Mailing List Management</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../nagios/">Nagios</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../patch-panels/">Patch Panels</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../peering-manager/">Peering Manager</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../peering-matrix/">Peering Matrix</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../peeringdb/">PeeringDB</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../rir-objects/">RIR Objects</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../reseller/">Reseller Functionality</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../route-collectors/">Route Collectors</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Route Servers</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#configuration-generation-features">Configuration Generation Features</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#setting-up">Setting Up</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#per-asn-import-export-filters">Per ASN Import / Export Filters</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#displaying-filtered-prefixes">Displaying Filtered Prefixes</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#well-known-filtering-communities">Well-Known Filtering Communities</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#rfc1997-passthru">RFC1997 Passthru</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#legacy-prefix-analysis-tool">Legacy Prefix Analysis Tool</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#limitations-and-caveats">Limitations and Caveats</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#setting-up_1">Setting Up</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../routers/">Router Configuration</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../rpki/">RPKI</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../skinning/">Skinning</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../grapher/smokeping/">Smokeping</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../static-content/">Static Content</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../tacacs/">TACACS</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Grapher</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../grapher/introduction/">Introduction</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../grapher/api/">API &amp; Permissions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../grapher/mrtg/">Backend: MRTG</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../grapher/sflow/">Backend: sflow</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../grapher/smokeping/">Backend: Smokeping</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Sflow Support</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../sflow/">Introduction</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../sflow-p2p/">Peer-to-peer Graphs</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Development</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/introduction/">Introduction</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/api/">API</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/authentication/">Authentication</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/ci/">Continuous Integration</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/cla/">Contributer License Agreement</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/docker/">Docker</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/docs/">Documentation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/forms/">Forms</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/frontend-crud/">Frontend CRUD</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/grapher/">Grapher</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/helpders/">Helpers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/looking-glass/">Looking Glass</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/release-procedure/">Release Procedure</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/telescope/">Telescope</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/users/">Users</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/vagrant/">Vagrant</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">IXP Manager Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Features &raquo;</li>
        
      
    
    <li>Route Servers</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/inex/ixp-manager-docs-md/edit/master/docs/features/route-servers.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="route-servers">Route Servers<a class="headerlink" href="#route-servers" title="Permanent link"></a></h1>
<blockquote>
<p><strong>Prerequisite Reading:</strong> Ensure you first familiarize yourself with <a href="../routers/">the generic documentation on managing and generating router configurations here</a>.</p>
</blockquote>
<p>Normally on a peering exchange, all connected parties will establish bilateral peering relationships with each other customer connected to the exchange. As the number of connected parties increases, it becomes increasingly more difficult to manage peering relationships with customers of the exchange. A typical peering exchange full-mesh eBGP configuration might look something similar to the diagram on the left hand side.</p>
<p><img alt="Route Servers Diagram" src="../img/rs-diagram.png" /></p>
<p>The full-mesh BGP session relationship scenario requires that each BGP speaker configure and manage BGP sessions to every other BGP speaker on the exchange. In this example, a full-mesh setup requires 7 BGP sessions per member router, and this increases every time a new member connects to the exchange.</p>
<p>However, by using a route servers for peering relationships, the number of BGP sessions per router stays at two: one for each route server (assuming a resilient set up). Clearly this is a more sustainable way of maintaining IXP peering relationships with a large number of participants.</p>
<h2 id="configuration-generation-features">Configuration Generation Features<a class="headerlink" href="#configuration-generation-features" title="Permanent link"></a></h2>
<p>Please <a href="../routers/">review the generic router documentation</a> to learn how to automatically generate route server configurations. This section goes into a bit more specific detail on INEX's route server configuration (as shipped with IXP Manager) and why it's safe to use.</p>
<p>You should also look at the following resources:</p>
<ul>
<li>watch the <em>IXP Manager Update &amp; Route Server Configuration</em> presentation from the 32nd Euro-IX Forum held in Galway, Ireland, April 2018: [<a href="https://www.ixpmanager.org/media/2018/20180417-euroix-ixpmanager.pdf">pdf</a>] [<a href="https://www.ixpmanager.org/videos/201804-euroix.mp4">video</a>].</li>
<li>to fully understand RPKI with IXP Manager, <a href="https://www.inex.ie/inex-news/shiny-new-route-servers/">watch our presentation</a> from APRICOT 2019.</li>
<li><a href="https://youtu.be/cqhJwuBaxxQ?t=1549">read this article</a> on INEX's website.</li>
</ul>
<p>The features of the route server configurations that IXP Manager generates include:</p>
<ul>
<li><a href="../rpki/">RPKI support</a> when using the Bird v2 templates;</li>
<li>full prefix filtering based on IRRDB entries (can be disabled on a per member basis if required) - see <a href="../irrdb/">the IRRDB documentation here</a>;</li>
<li>full origin ASN filtering based on IRRDB entries (can be disabled on a per member basis if required);</li>
<li>in all cases, prefix filtering for IPv4 and v6 based on the IANA special purpose registries (also known as bogon lists);</li>
<li>ensuring next hop is the neighbor address to ensure no next hop hijacking;</li>
<li>max prefix limits;</li>
<li>multiple VLAN interfaces for a single member supported;</li>
<li>large BGP communities supported;</li>
<li><a href="#rfc1997-passthru">rfc1997 passthru / interpretation</a> switch (&gt;= v5.2.0);</li>
<li>nearly 15 years of production use and experience.</li>
</ul>
<p>With Bird v2 support in IXP Manager v5, we provide better looking glass integration and other tooling to show members which prefixes are filtered and why. The Bird v2 filtering mechanism is as follows:</p>
<ol>
<li>Filter small prefixes (default is &gt; /24 / /48 for ipv4 / ipv6).</li>
<li>Filter martians / bogons prefixes (<a href="https://github.com/inex/IXP-Manager/blob/master/resources/views/api/v4/router/server/bird2/header.foil.php">see this template</a>).</li>
<li>Sanity check - filter prefixes with no AS path or &gt; 64 ASNs in AS path.</li>
<li>Sanity check to ensure peer AS is the same as first AS in the prefix’s AS path.</li>
<li>Prevent next-hop hijacking. This occurs when a participant advertises a prefix with a next hop IP other than their own. An exception exists to allow participants with multiple connections advertise their other router (next-hop within the same AS).</li>
<li>Filter known transit networks - see FIXME</li>
<li>IRRDB filtering: ensure origin AS is in set of ASNs from member AS-SET.</li>
<li>RPKI:<ul>
<li>Valid -&gt; accept</li>
<li>Invalid -&gt; drop</li>
</ul>
</li>
<li>RPKI Unknown -&gt; revert to standard IRRDB prefix filtering.</li>
</ol>
<h2 id="setting-up">Setting Up<a class="headerlink" href="#setting-up" title="Permanent link"></a></h2>
<p>You first need to add your route servers to the <strong>IXP Manager</strong> routers database. See <a href="../routers/">this page on how to do that</a>.</p>
<p>Typically an IXP's route server service will have a dedicated ASN that is different to the IXP's own management / route collector ASN. As such, you need to add a new <em>internal</em> customer to IXP Manager.</p>
<p><strong>You are strongly advised to use / request a 16-bit ASN from your RIR for route server use. If you do not, you will be unable to offer your members standard community based filtering.</strong></p>
<p>Here's an example from INEX for our <em>route server #1</em>:</p>
<p><img alt="Route Servers INEX Customer" src="../img/rs-inex-customer.png" /></p>
<p>You then need to create an interface for this route server on each peering LAN where the service will be offered. Here again is INEX's example from our peering LAN1 in Dublin:</p>
<p><img alt="Route Servers INEX VLAN Interface Entry" src="../img/rs-inex-vli.png" /></p>
<p>There's a couple things to note in the above:</p>
<ol>
<li><em>AS112 Client</em> is checked which means (so long as <em>Route Server Client</em> is checked on the <a href="../as112/">AS112 service</a>) the AS112 service will peer with the route servers.</li>
<li><em>Apply IRRDB Filtering</em> has no meaning here as this is the route server rather than the route server client.</li>
</ol>
<h2 id="per-asn-import-export-filters">Per ASN Import / Export Filters<a class="headerlink" href="#per-asn-import-export-filters" title="Permanent link"></a></h2>
<p>There are occasions where you may need to override the default filtering mechanism for some members. IXP Manager allows you to create custom Bird2 checks at the <strong>start</strong> of the standard import / export filters when using <strong>Bird2</strong> (not supported on the older Bird v1 configuration).</p>
<p>To do this, you must <a href="../skinning/">create skinned files</a> named after the ASN. For example, let's assume your skin name is <code>example</code> and the ASN of the member you want to apply custom filtering to is <code>64511</code>; then you would an export and/or import filter in files named:</p>
<ul>
<li><code>$IXPROOT/resources/skins/example/api/v4/router/server/bird2/f_import_as64511.foil.php</code></li>
<li><code>$IXPROOT/resources/skins/example/api/v4/router/server/bird2/f_export_as64511.foil.php</code></li>
</ul>
<p>You'll see <a href="https://github.com/inex/IXP-Manager/tree/master/resources/skins/inex/api/v4/router/server/bird2">real examples from INEX here</a>. Remember that these are placed at the <em>beginning of the standard filters</em> allowing you to explicitly <code>accept</code> or <code>reject</code> the prefix. However, remember that INEX <code>accepts</code> prefixes on import always but tags prefixes for filtering with large community <code>routerasn:1101:x</code> - please see the resources referenced above for details on this.</p>
<h2 id="displaying-filtered-prefixes">Displaying Filtered Prefixes<a class="headerlink" href="#displaying-filtered-prefixes" title="Permanent link"></a></h2>
<p>Using Bird v2 and internal large communities, we have completely overhauled how we show end users what prefixes are filtered by the route servers.</p>
<p>If you are running route servers using the Bird v2 configuration and if you have installed <a href="../looking-glass/">the looking glass</a> then you should set the following in your <code>.env</code> file:</p>
<pre class="highlight"><code>IXP_FE_FRONTEND_DISABLED_FILTERED_PREFIXES=false</code></pre>

<p><img alt="Route Servers Filtered Prefixes" src="../img/rs-filtered-prefixes.png" /></p>
<p>This is a live view gathered from each Bird v2 route server with a looking glass.</p>
<p>Please see <a href="https://www.ixpmanager.org/presentations">our presentations from 2019</a> for more information on this. Particularly the UKNOF one from September 2019 would be the most up to date.</p>
<p>For a route server to be polled for a customer by this tool, the following conditions must be met:</p>
<ol>
<li>the customer must be a route server client and the vlan cannot be a private vlan;</li>
<li>only enabled IP protocols are queried for a vlan interface;</li>
<li>the router server must be allocated to the same vlan and have a instance for the IP protocol;</li>
<li>the route server cannot be marked as quarantine;</li>
<li>the route server muct have an API configured;</li>
<li>the route server must be <em>a route server</em> (remember you can provision collectors and AS112 routers via IXP Manager also);</li>
<li>the route server must have large communities enabled;</li>
</ol>
<p>It is also critical that the <a href="../looking-glass/">looking glass</a> for the route server works.</p>
<p><strong>Caching:</strong> for large members with tens of thousands of routes, gathering filtered prefixes can be an expensive task for IXP Manager and the route server (expensive in terms of time and CPU cycles). As such, this feature of IXP Manager <strong>requires</strong> the use of a persistent cache. We recommend memcached for this which is installed and enabled by default with the automated installer.</p>
<h2 id="well-known-filtering-communities">Well-Known Filtering Communities<a class="headerlink" href="#well-known-filtering-communities" title="Permanent link"></a></h2>
<p>The route server configuration that <strong>IXP Manager</strong> generates by default provides well known communities to allow members to control the distribution of their prefixes.</p>
<p><strong>NB:</strong> in the following, <code>rs-asn</code> is the AS number of the IXP's route server.</p>
<p>The standard communities are defined as follows:</p>
<p><br><br></p>
<table>
<thead>
<tr>
<th>Description</th>
<th>Community</th>
</tr>
</thead>
<tbody>
<tr>
<td>Prevent announcement of a prefix to a peer</td>
<td><code>0:peer-as</code></td>
</tr>
<tr>
<td>Announce a route to a certain peer</td>
<td><code>rs-asn:peer-as</code></td>
</tr>
<tr>
<td>Prevent announcement of a prefix to all peers</td>
<td><code>0:rs-asn</code></td>
</tr>
<tr>
<td>Announce a route to all peers</td>
<td><code>rs-asn:rs-asn</code></td>
</tr>
</tbody>
</table>
<p>The community for announcing a route to all peers (<code>rs-asn:rs-asn</code>) is the default behaviour and so there is no need to tag routes with this.</p>
<p><strong>Example #1:</strong> if a member wishes to to instruct the IXP route server (with AS64500) to distribute a particular prefix only to AS64496 and AS64503, the prefix should be tagged with communities: <code>0:64500 64500:64496 64500:64503</code> (i.e. <em>announce to no one except...</em>).</p>
<p><strong>Example #2:</strong> for a member to to announce a prefix to all IXP route server participants, excluding AS64497, the prefix should be tagged with only community <code>0:64497</code>.</p>
<p>If you enabled support for BGP large communities, then the following large communities can be used:</p>
<table>
<thead>
<tr>
<th>Description</th>
<th>Community</th>
</tr>
</thead>
<tbody>
<tr>
<td>Prevent announcement of a prefix to a peer</td>
<td><code>rs-asn:0:peer-as</code></td>
</tr>
<tr>
<td>Announce a route to a certain peer</td>
<td><code>rs-asn:1:peer-as</code></td>
</tr>
<tr>
<td>Prevent announcement of a prefix to all peers</td>
<td><code>rs-asn:0:0</code></td>
</tr>
<tr>
<td>Announce a route to all peers</td>
<td><code>rs-asn:1:0</code></td>
</tr>
</tbody>
</table>
<blockquote>
<p>If your route server is configured to support large communities, then you should advise your members to use these over standard 16-bit communities as a large number of networks now have a 32-bit ASN. You should also advise them <strong>not to mix standard 16-bit communities and large communities</strong> – please choose one or the other.</p>
</blockquote>
<p>Lastly, with BGP large communities, AS path prepending control is also available by default using the following large BGP communities:</p>
<table>
<thead>
<tr>
<th>Description</th>
<th>Community</th>
</tr>
</thead>
<tbody>
<tr>
<td>Prepend to peer AS once</td>
<td><code>rs-asn:101:peer-as</code></td>
</tr>
<tr>
<td>Prepend to peer AS twice</td>
<td><code>rs-asn:102:peer-as</code></td>
</tr>
<tr>
<td>Prepend to peer AS three times</td>
<td><code>rs-asn:103:peer-as</code></td>
</tr>
</tbody>
</table>
<h2 id="rfc1997-passthru">RFC1997 Passthru<a class="headerlink" href="#rfc1997-passthru" title="Permanent link"></a></h2>
<p><a href="https://tools.ietf.org/html/rfc1997">RFC1997</a> defines some well-known communities including <code>NO_EXPORT</code> (<code>0xFFFFFF01 / 65535:65281</code>) and <code>NO_ADVERTISE</code> and states that they <em>have global significance and their operations shall be implemented in any community-attribute-aware BGP speaker</em>.</p>
<p>According to <a href="https://tools.ietf.org/html/rfc7947">RFC7947</a>, it is a matter of local policy whether these well-known communities are interpreted or passed through. Historically, some IXP route servers interpret them and some pass them through. As such the behaviour of these well-known communities is not well-understood when it comes to route servers and this topic has been the subject of a good deal of debate in the IXP community over the years.</p>
<p>In 2017, INEX and LONAP published <a href="https://www.ietf.org/archive/id/draft-hilliard-grow-no-export-via-rs-00.txt">draft-hilliard-grow-no-export-via-rs-00</a> to try and create some consensus on this. While the draft was not accepted as a standard, the discussion drew a conclusion that these well-known communities should not be interpreted by the route server but passed through.</p>
<h2 id="legacy-prefix-analysis-tool">Legacy Prefix Analysis Tool<a class="headerlink" href="#legacy-prefix-analysis-tool" title="Permanent link"></a></h2>
<p>The older but deprecated means of viewing filtered prefixes was the <em>Route Server Prefix Analysis tool</em> which allows your members to examine what routes they are advertising to the route servers, which are being accepted and which are being rejected.</p>
<h3 id="limitations-and-caveats">Limitations and Caveats<a class="headerlink" href="#limitations-and-caveats" title="Permanent link"></a></h3>
<p>Implemented as a Perl script which accesses the database directly. The script can also only be used on one LAN and one route server. Thus, pick you most popular LAN and route server.</p>
<h3 id="setting-up_1">Setting Up<a class="headerlink" href="#setting-up_1" title="Permanent link"></a></h3>
<ul>
<li>Download <a href="https://github.com/inex/IXP-Manager/blob/master/tools/runtime/route-servers/compare-route-server-prefixes.pl">this script</a> to your route server;</li>
<li>Ensure you install and configure the IXP Manager Perl library on this route server also;</li>
<li>Edit the <code>compare-route-server-prefixes.pl</code> script and set the Bird configuration file and socket (you can find the position in the file by searching for <code>XXX-SET-ME</code>);</li>
<li>See also <a href="https://www.inex.ie/pipermail/ixpmanager/2015-May/000558.html">this diff</a> for further hints;</li>
<li>Execute the <code>compare-route-server-prefixes.pl</code> script a few times a day as you think appropriate;</li>
<li>In your <code>.env</code> file, ensure the following is set:</li>
</ul>
<pre class="highlight"><code class="language-ini">IXP_FE_FRONTEND_DISABLED_RS_PREFIXES=false</code></pre>

<p>Once you make the last change above, the prefix analysis tool will be available to administrators and members on IXP Manager.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../routers/" class="btn btn-neutral float-right" title="Router Configuration">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../route-collectors/" class="btn btn-neutral" title="Route Collectors"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>&copy; 2017-2020, Internet Neutral Exchange Association Company Limited by Guarantee (INEX).<br><a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://licensebuttons.net/l/by-sa/4.0/80x15.png" /></a>&nbsp;This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p>
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/inex/ixp-manager-docs-md/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../route-collectors/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../routers/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
